/** User Model
 * Generated by using a mongoose Schema
 * two keys required: 
 * @constructor
    * @key {string} email - must match a REGEX to ensure is valid
    * @key {string} password - unique - password is validated by passwordValidator (password.js)
 * 
 * Mongoose unique validator is used to ensure the same email cannot be used twice or more to create different user accounts
 * 
 */

const mongoose = require('mongoose');
const sanitizer = require('mongoose-sanitize');
const uniqueValidator = require('mongoose-unique-validator');

const userSchema = mongoose.Schema({
    email: { type: String, required: true, unique: true, match: [/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/g, "Entrez une adresse email correcte, s'il vous pla√Æt."] },
    password: { type: String, required: true }
});

userSchema.plugin(uniqueValidator);
userSchema.plugin(sanitizer);

module.exports = mongoose.model('User', userSchema);